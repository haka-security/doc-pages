


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.9.1. Packet module &mdash; Haka runtime 0.3.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/haka.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/breathe.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/scripts.js"></script>
    <script type="text/javascript" src="../../../_static/js/vendor/modernizr.js"></script>
    <script type="text/javascript" src="../../../_static/js/foundation/foundation.js"></script>
    <script type="text/javascript" src="../../../_static/js/foundation/foundation.topbar.js"></script>
    <link rel="top" title="Haka runtime 0.3.0 documentation" href="../../../index.html" />
    <link rel="up" title="3.8. Modules" href="module.html" />
    <link rel="next" title="3.9.2. Log module" href="log_module.html" />
    <link rel="prev" title="3.8. Modules" href="module.html" /> 
  </head>
  <body>


<header id="header" role="banner">
	<div class="row">
		<div class="medium-6 columns">
			<h1 class="title"><a rel="home" title="Haka" href="http://www.haka-security.org">Haka</a></h1>
			<h2 class="description">Software Defined Security</h2>
		</div>
		<div class="medium-6 columns">
			<div id="version">Version 0.3.0</div>
		</div>
	</div>
</header>

<div class="contain-to-grid sticky">
	

<nav id="navbar" class="top-bar" data-topbar>
	<ul class="title-area">
		<!-- This is required for toggle-topbar to work -->
		<li class="name"></li>
		<li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
	</ul>
	<section class="top-bar-section">
		<ul class="left">
			<li class=" ">
				<a href="../../user/userindex.html">Users</a>
			</li>
			<li class=" ">
				<a href="../../ref/refindex.html" class="../../ref/refindex.html">References</a>
			</li>
			<li class=" active">
				<a href="../devindex.html" class="">Developers</a>
			</li>
			<li class=" ">
				<a href="../../faq.html" class="">Faq</a>
			</li>
			<li class="has-form">


	<form class="search" action="../../../search.html" method="get" id="searchbox" style="display: none">
		<input type="hidden" name="area" value="default" />
		<input type="hidden" name="check_keywords" value="yes" />
		<div class="row collapse">
			<div class="medium-11 columns">
				<input type="text" name="q" placeholder="Search" />
			</div>
			<div class="medium-1 columns" id="clean-search-highlight">
			</div>
		</div>
	</form>
	<script type="text/javascript">$('#searchbox').show(0);</script>
</li>
		</ul>
		<ul class="right">
				<li class="right"><a href="log_module.html" title="3.9.2. Log module">Next &rarr;</a></li>
				<li class="right"><a href="module.html" title="3.8. Modules">&larr; Prev</a></li>
				<li class="right"><a href="module.html" title="3.8. Modules">Up &uarr;</a></li>

			<li class=" right"><a href="../../../genindex.html">Index</a></li>
			<li class=" right"><a href="../../../haka-modindex.html">Modules</a></li>
		</ul>
	</section>
</nav>
</div>
<div id="content">
	<div class="row">
		<ul id="breadcrumb" class="breadcrumbs medium-12 columns">
			
			<li><a href="../devindex.html">Welcome to Haka&#8217;s Developer Guide!</a></li>
			
			<li><a href="../devref.html">3. Developer reference guide</a></li>
			
			<li><a href="module.html">3.8. Modules</a></li>
			
			<li class="current"><a href="#">3.9.1. Packet module</a></li>
		</ul>
	</div>
	<div class="row">
		<div class="medium-12 columns">
			
  <div class="section" id="packet-module">
<h1>3.9.1. Packet module<a class="headerlink" href="#packet-module" title="Permalink to this headline">Â¶</a></h1>
<p></p>
<p>Packet capture module. </p>
<em>Enums</em><blockquote>
<div><p><span class="target" id="project0packet__module_8h_1a442f07e5189554ce784922f72c3e7d34"></span><strong>filter_result enum</strong></p>
<blockquote>
<div><p></p>
<p>Filtering result. </p>
<p><em>Values:</em></p>
<ul class="breatheenumvalues">
<li><tt class="first docutils literal"><span class="pre">FILTER_ACCEPT</span></tt> - <p>Accept packet result. </p>
</li>
<li><tt class="first docutils literal"><span class="pre">FILTER_DROP</span></tt> - <p>Drop packet result. </p>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><p id="project0structpacket__module"><em>class</em> <strong>packet_module</strong></p>
<blockquote>
<div><p></p>
<p>Opaque state structure. Packet module used to interact with the low-level packets. The module will be used to receive packets and set a verdict on them. It also define an interface to access the packet fields. </p>
<em>Public Members</em><blockquote>
<div><p><span class="target" id="project0structpacket__module_1a48184128a1ae49690219e7249e8c03a2"></span>struct  <a class="reference internal" href="module.html#project0structmodule"><em>module</em></a> <strong>module</strong></p>
<blockquote>
<div><p></p>
<p>Module structure. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a7248915c9cd7ad2691ceb179c916e8f1"></span><a class="reference internal" href="utils.html#project0types_8h_1a97a80ca1602ebf2303258971a2c938e2"><em>bool</em></a> (* <strong>multi_threaded</strong>)()</p>
<blockquote>
<div><p></p>
<p>Get if the module support multi-threading. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1aec4f3c850153ca0cc6c584682ce516c2"></span><a class="reference internal" href="utils.html#project0types_8h_1a97a80ca1602ebf2303258971a2c938e2"><em>bool</em></a> (* <strong>pass_through</strong>)()</p>
<blockquote>
<div><p></p>
<p>Get the capture mode. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1af158830cb5fed6486aec8373e673f0d8"></span><a class="reference internal" href="utils.html#project0types_8h_1a97a80ca1602ebf2303258971a2c938e2"><em>bool</em></a> (* <strong>is_realtime</strong>)()</p>
<blockquote>
<div><p></p>
<p>Check if the module is realtime or not. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a07c2e5e0304a4eb52b6e7493c47ad85c"></span>struct packet_module_state *(* <strong>init_state</strong>)(int thread_id)</p>
<blockquote>
<div><p></p>
<p>Initialize the packet module state. This function will be called to create multiple states if the module supports multi-threading. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a5791ec55d053fbf1e0497856cde791a4"></span>void(* <strong>cleanup_state</strong>)(struct packet_module_state *state)</p>
<blockquote>
<div><p></p>
<p>Cleanup the packet module state. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a607b18fe79bf80bf415bebb623bfb1c6"></span>int(* <strong>receive</strong>)(struct packet_module_state *state, struct packet **pkt)</p>
<blockquote>
<div><p></p>
<p><p>Callback used to receive a new packet. This function should block until a packet is received.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Non zero in case of error. </dd>
</dl>
</p>
</p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1af865f2afac27585f96813773f2d8ca34"></span>void(* <strong>verdict</strong>)(struct packet *pkt, filter_result result)</p>
<blockquote>
<div><p></p>
<p><p>Apply a verdict on a received packet. The module should then apply this verdict on the underlying packet.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><tt class="first docutils literal"><span class="pre">pkt</span></tt> - <p>The received packet. After calling this function the packet address is never used again by the application but allow the module to free it if needed. </p>
</li>
<li><tt class="first docutils literal"><span class="pre">result</span></tt> - <p>The verdict to apply to this packet. </p>
</li>
</ul>
</dd>
</dl>
</p>
</p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a1322582d4e781de4b150a793106fcbd5"></span><a class="reference internal" href="utils.html#project0types_8h_1a6861bed95d73703b3730053f3a6065bf"><em>uint64</em></a> (* <strong>get_id</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Get the identifier of a packet. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a6f2807baef20deed101a915c2bc1b1cd"></span>const char *(* <strong>get_dissector</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Get the packet dissector. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a7d97a9ccc24a37cc13ec22f922b47235"></span>void(* <strong>release_packet</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Release the packet and free its memory. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1ab9e5d116ee7f0611001c850e5c607c08"></span>enum  <a class="reference internal" href="packet.html#project0packet_8h_1a779fe7d9d304f8d6e92b3036ff58de4a"><em>packet_status</em></a> (* <strong>packet_getstate</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Get packet status. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a2a328483face1ed0ae9c1043e571c823"></span>struct  <a class="reference internal" href="packet.html#project0structpacket"><em>packet</em></a>  *(* <strong>new_packet</strong>)(struct packet_module_state *state, size_t size)</p>
<blockquote>
<div><p></p>
<p>Create a new packet. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1a5364dbc4d75cb4b875bfaf468d9ec2e0"></span><a class="reference internal" href="utils.html#project0types_8h_1a97a80ca1602ebf2303258971a2c938e2"><em>bool</em></a> (* <strong>send_packet</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Send a forged packet. This packet will be received again by Haka as a regular packet on the network. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1adcc940f36f852b81f172912231914a8b"></span>size_t(* <strong>get_mtu</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Get the mtu for a packet. </p>
</div></blockquote>
<p><span class="target" id="project0structpacket__module_1ab9d55df0dd39061bee932e22e3f7cf51"></span>struct  <a class="reference internal" href="time.html#project0structtime"><em>time</em></a>  *(* <strong>get_timestamp</strong>)(struct packet *pkt)</p>
<blockquote>
<div><p></p>
<p>Get the packet timestamp. </p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</p>
</div>


		</div>
	</div>
</div>



<footer id="footer">
	<div class="row" role="complementary">
		<div class="medium-12 columns">
			&copy; Copyright 2014, Arkoon Network Security, OpenWide and Telecom ParisTech.
		</div>
	</div>
</footer>
<script>
	  $(document).foundation();
</script>



<script type="text/javascript" src="http://www.haka-security.org/js/track.js"></script>


  </body>
</html>